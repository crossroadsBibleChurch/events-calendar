<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>DAKboard 2026 - Custom Button Layout</title>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@6.1.15/index.global.min.js"></script>

    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; background: #000; color: #eee; overflow-y: auto; }
        
        /* --- FOCUS FADE --- */
        #calendar { max-width: 100%; padding: 0 20px 20px 20px; transition: opacity 0.4s ease; }
        .is-zoomed #calendar { opacity: 0.2 !important; pointer-events: none; }

        /* --- STICKY YEAR TOOLBAR --- */
        .fc .fc-header-toolbar {
            position: sticky; top: 0; background: #000; z-index: 1000;
            padding: 15px 0; margin-bottom: 10px !important; border-bottom: 2px solid #333;
        }

        /* --- YEAR VIEW FONT --- */
        .fc-multimonth { font-size: 1.32em !important; }
        .fc-multimonth-title { font-size: 1.5em !important; color: #fff !important; cursor: pointer !important; }

        /* --- THE SHADING --- */
        .fc-daygrid-day { background-color: #1a1a1a !important; border: 1px solid #333 !important; }
        .fc .fc-day-other { background-color: #000000 !important; }

        /* --- NAVIGATION BUTTONS --- */
        .fc .fc-button-primary { text-transform: lowercase !important; font-weight: 400 !important; }
        
        /* Custom Close Button Styling */
        .fc .fc-closeBtn-button {
            background-color: #2c3e50 !important;
            border: 1px solid #2c3e50 !important;
            color: #fff !important;
            padding: 0.4em 0.8em !important;
            font-size: 1em !important;
            border-radius: 0.25em !important;
            line-height: 1.5 !important;
            margin-left: 1.2em !important; /* Visual gap from nav cluster */
            text-transform: lowercase !important;
            font-weight: 400 !important;
        }
        .fc .fc-closeBtn-button:hover { background-color: #1e2b37 !important; border-color: #1e2b37 !important; }

        /* --- EVENT ENGINE --- */
        .fc-daygrid-event-dot { display: none !important; } 
        .fc-event { cursor: pointer !important; margin: 1px 4px !important; border: none !important; background: transparent !important; }
        .fc-event-all-day, .fc-daygrid-block-event, .fc-h-event {
            background-color: #333333 !important; border: 2px solid #555555 !important; border-radius: 6px !important;
        }
        .fc-event-main { padding: 1px 8px !important; display: flex !important; align-items: baseline !important; overflow: hidden !important; }
        .fc-event-title { color: #8fc7ff !important; font-weight: bold !important; font-size: 0.85em !important; }
        .fc-event-time { color: #dcdcdc !important; font-weight: 700 !important; font-size: 0.75em !important; margin-right: 4px !important; }

        /* --- POPOVER & ZOOM --- */
        .zoom-container { 
            display: none; position: fixed; background: rgba(0,0,0,0.98); z-index: 2000; 
            left: 50%; top: 50%; transform: translate(-50%, -50%);
            width: 80vw; height: 80vh; border: 3px solid #555; border-radius: 20px; padding: 30px; overflow: hidden; 
        }
        #zoomCalendar { font-size: 2.3em !important; height: 100% !important; }
        #zoomCalendar .fc-daygrid-body, #zoomCalendar .fc-daygrid-body table, #zoomCalendar .fc-scrollgrid-sync-table { height: 100% !important; width: 100% !important; }
        #zoomCalendar .fc-daygrid-row { flex: 1 1 0px !important; } 

        /* --- DETAIL MODAL --- */
        #customModal { 
            display: none; position: fixed; z-index: 6000; left: 50%; top: 50%; transform: translate(-50%, -50%); 
            width: 90%; max-width: 1100px; background: #1a1a1a; border: 3px solid #8fc7ff; border-radius: 30px; padding: 60px; 
        }
    </style>
</head>
<body id="mainBody">
    <div id="calendar"></div>
    <div id="zoomOverlay" class="zoom-container">
        <div id="zoomCalendar"></div>
    </div>
    
    <div id="customModal">
        <div id="mTitle" style="color:#8fc7ff; font-size: 3.5em; font-weight: bold;"></div>
        <div id="mTime" style="color:#fff; font-size: 2.2em; margin: 25px 0; border-bottom: 2px solid #333; padding-bottom: 15px;"></div>
        <div id="mDesc" style="color:#ccc; font-size: 2.1em;"></div>
        <button onclick="closeModal()" style="margin-top:40px; float:right; background:#444444; color:#fff; padding:20px 40px; border-radius:10px; font-size: 1.6em; cursor:pointer;">close</button>
    </div>

    <script>
        var mainCal, zoomCal;
        var API_KEY = 'AIzaSyD1icSp6SOC9A0yIsy0rGk0mr1B60sW2Zo';
        var CAL_ID = 'eventsatcrossroads@gmail.com';

        function closeModal() { document.getElementById('customModal').style.display = 'none'; }
        
        function closeZoom() { 
            document.getElementById('zoomOverlay').style.display = 'none'; 
            document.getElementById('mainBody').classList.remove('is-zoomed');
            document.body.style.overflow = 'auto'; 
        }

        function formatDetails(event) {
            const start = event.start;
            let end = event.end ? new Date(event.end) : new Date(start);
            let displayEnd = new Date(end);
            if (event.allDay && end > start) { displayEnd.setDate(displayEnd.getDate() - 1); }
            const dateFmt = { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' };
            const sameDay = start.toDateString() === displayEnd.toDateString();
            if (event.allDay) {
                if (sameDay) return start.toLocaleDateString(undefined, dateFmt);
                return start.toLocaleDateString(undefined, {weekday:'long', month:'long', day:'numeric'}) + " — " + displayEnd.toLocaleDateString(undefined, dateFmt);
            }
            let timeStr = start.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'}) + " – " + end.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
            return (sameDay ? start.toLocaleDateString(undefined, dateFmt) : start.toLocaleDateString(undefined, {weekday:'long', month:'long', day:'numeric'}) + " – " + displayEnd.toLocaleDateString(undefined, dateFmt)) + "<br>" + timeStr;
        }

        function initCalendar(el, view, date, isZoom) {
            return new FullCalendar.Calendar(el, {
                googleCalendarApiKey: API_KEY,
                eventSources: [{ 
                    googleCalendarId: CAL_ID,
                    eventDataTransform: (e) => {
                        const d = (new Date(e.end) - new Date(e.start)) / 36e5;
                        if (d >= 24) e.allDay = true;
                        return e;
                    }
                }],
                initialView: view,
                initialDate: date || new Date(),
                multiMonthMaxColumns: 3,
                headerToolbar: { 
                    // Move today button between prev/next
                    left: isZoom ? 'prev today next closeBtn' : 'prev today next', 
                    center: 'title', 
                    right: '' 
                },
                buttonText: {
                    today: isZoom ? 'current month' : 'this year'
                },
                customButtons: {
                    closeBtn: { text: 'close', click: function() { closeZoom(); } }
                },
                eventTimeFormat: { hour: 'numeric', minute: '2-digit', meridiem: 'narrow', omitZeroMinute: false },
                dayMaxEvents: 7,
                eventOrder: "-allDay,start",
                eventOrderStrict: true,
                height: isZoom ? '100%' : 'auto',
                contentHeight: isZoom ? '100%' : 'auto',
                expandRows: isZoom,
                dayCellDidMount: function(info) {
                    if (info.isOther) {
                        info.el.style.setProperty('background-color', '#000000', 'important');
                    }
                },
                eventClick: function(info) {
                    info.jsEvent.preventDefault();
                    document.getElementById('mTitle').innerText = info.event.title;
                    document.getElementById('mTime').innerHTML = formatDetails(info.event);
                    document.getElementById('mDesc').innerHTML = (info.event.extendedProps.description || "no description provided.").replace(/\n/g, "<br>");
                    document.getElementById('customModal').style.display = 'block';
                }
            });
        }

        window.onload = function() {
            mainCal = initCalendar(document.getElementById('calendar'), 'multiMonthYear', null, false);
            mainCal.render();
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('fc-multimonth-title')) {
                    document.getElementById('zoomOverlay').style.display = 'block';
                    document.getElementById('mainBody').classList.add('is-zoomed');
                    document.body.style.overflow = 'hidden';
                    if (zoomCal) zoomCal.destroy();
                    zoomCal = initCalendar(document.getElementById('zoomCalendar'), 'dayGridMonth', new Date(e.target.innerText + ", " + mainCal.view.title), true);
                    zoomCal.render();
                }
            });
        };
    </script>
</body>
</html>
