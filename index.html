<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>DAKboard Yearly Zoom Dark</title>
    
    <!-- THE CORE ENGINE -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
    
    <!-- THE GOOGLE PLUGIN -->
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@6.1.15/index.global.min.js"></script>


    <style>
        /* --- GLOBAL DARK THEME --- */
        body { 
            margin: 0; padding: 10px; font-family: sans-serif; 
            background: #111111; color: #eeeeee; overflow: hidden;
        }
        #calendar { max-width: 100%; margin: 0 auto; height: 98vh; }
        
        /* --- TITLES & SIZING --- */
        .fc-toolbar-title { font-size: 2.4em !important; color: #ffffff; font-weight: bold; }
        .fc-multimonth-title { 
            font-size: 2.0em !important; color: #ffffff; font-weight: bold; 
            padding: 10px 0; border-bottom: 2px solid #333; cursor: pointer; 
        }
        .fc-multimonth-title:hover { color: #1e90ff; }

        /* --- GRID STYLING --- */
        .fc { font-size: 0.58em; color: #eeeeee; }
        .fc-theme-standard td, .fc-theme-standard th { background-color: #1a1a1a !important; border: 1px solid #2a2a2a !important; }
        .fc-daygrid-day-number { color: #bbbbbb; font-weight: 600; }
        .fc-col-header-cell-cushion { color: #888; text-transform: uppercase; }

        /* --- EVENT STYLING --- */
        .fc-daygrid-event-dot { display: none !important; }
        .fc-event { background: transparent !important; border: none !important; color: #1e90ff !important; font-weight: 500; cursor: pointer; }
        .fc-daygrid-block-event { background-color: #444444 !important; border: 1px solid #555 !important; border-radius: 3px !important; }
        .fc-daygrid-block-event .fc-event-title { color: #1e90ff !important; font-weight: bold !important; }

        /* --- ZOOM OVERLAY --- */
        #zoomOverlay {
            display: none; position: fixed; z-index: 1000; left: 10%; top: 10%; 
            width: 80%; height: 80vh; background: #1a1a1a; border: 3px solid #1e90ff; 
            border-radius: 15px; box-shadow: 0 0 100px rgba(0,0,0,1); padding: 30px;
        }
        #zoomCalendar { height: 90%; width: 100%; }
        #closeZoom { position: absolute; top: 10px; right: 15px; background: #444; color: #fff; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        .fc-button { background-color: #333 !important; border: 1px solid #444 !important; color: #fff !important; font-size: 0.9em !important; }
    </style>
</head>
<body>
    <div id="calendar"></div>

    <div id="zoomOverlay">
        <button id="closeZoom" onclick="closeZoom()">Close X</button>
        <div id="zoomCalendar"></div>
    </div>

    <script>
        var mainCal, zoomCal;
        
        // --- CONFIGURATION ---
        var API_KEY = 'AIzaSyD1icSp6SOC9A0yIsy0rGk0mr1B60sW2Zo';
        var CAL_ID = 'eventsatcrossroads@gmail.com';

        function closeZoom() { 
            document.getElementById('zoomOverlay').style.display = 'none'; 
        }

        window.onload = function() {
            function handleEventClick(info) {
                info.jsEvent.preventDefault();
                alert("Event: " + info.event.title + "\n" + (info.event.extendedProps.description || ""));
            }

            // 1. Initialize Main Year View
            mainCal = new FullCalendar.Calendar(document.getElementById('calendar'), {
                googleCalendarApiKey: API_KEY,
                events: { googleCalendarId: CAL_ID },
                initialView: 'multiMonthYear',
                multiMonthMaxColumns: 4,
                headerToolbar: { left: 'prev,next today', center: 'title', right: '' },
                buttonText: { today: 'Current Year' },
                height: 'auto',
                eventClick: handleEventClick
            });
            mainCal.render();

            // 2. Click Listener for Month Titles
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('fc-multimonth-title')) {
                    openZoom(e.target.innerText);
                }
            });

            function openZoom(titleText) {
                document.getElementById('zoomOverlay').style.display = 'block';
                
                setTimeout(function() {
                    var zoomEl = document.getElementById('zoomCalendar');
                    var clickedDate = new Date(titleText + " 1");

                    if (zoomCal) zoomCal.destroy();

                    zoomCal = new FullCalendar.Calendar(zoomEl, {
                        googleCalendarApiKey: API_KEY,
                        // Force the event source explicitly for the second instance
                        eventSources: [
                            {
                                googleCalendarId: CAL_ID,
                                className: 'google-event'
                            }
                        ],
                        initialView: 'dayGridMonth',
                        initialDate: clickedDate,
                        headerToolbar: false,
                        height: 'parent',
                        eventClick: handleEventClick
                    });

                    zoomCal.render();
                    
                    // Final wake-up to ensure events draw
                    zoomCal.refetchEvents();
                    window.dispatchEvent(new Event('resize'));
                }, 200);
            }
        };
    </script>
</body>
</html>
